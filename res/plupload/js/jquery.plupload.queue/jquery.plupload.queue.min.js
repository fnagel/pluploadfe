(function(b,p){function c(b){return plupload.translate(b)||b}function r(f,k){k.contents().each(function(f,c){c=b(c);c.is(".plupload")||c.remove()});k.prepend('<div class="plupload_wrapper plupload_scroll"><div id="'+f+'_container" class="plupload_container"><div class="plupload"><div class="plupload_header"><div class="plupload_header_content"><div class="plupload_header_title">'+c("Select files")+'</div><div class="plupload_header_text">'+c("Add files to the upload queue and click the start button.")+
'</div></div></div><div class="plupload_content"><div class="plupload_filelist_header"><div class="plupload_file_name">'+c("Filename")+'</div><div class="plupload_file_action">&nbsp;</div><div class="plupload_file_status"><span>'+c("Status")+'</span></div><div class="plupload_file_size">'+c("Size")+'</div><div class="plupload_clearer">&nbsp;</div></div><ul id="'+f+'_filelist" class="plupload_filelist"></ul><div class="plupload_filelist_footer"><div class="plupload_file_name"><div class="plupload_buttons"><a href="#" class="plupload_button plupload_add" id="'+
f+'_browse">'+c("Add Files")+'</a><a href="#" class="plupload_button plupload_start">'+c("Start Upload")+'</a></div><span class="plupload_upload_status"></span></div><div class="plupload_file_action"></div><div class="plupload_file_status"><span class="plupload_total_status">0%</span></div><div class="plupload_file_size"><span class="plupload_total_file_size">0 b</span></div><div class="plupload_progress"><div class="plupload_progress_container"><div class="plupload_progress_bar"></div></div></div><div class="plupload_clearer">&nbsp;</div></div></div></div></div><input type="hidden" id="'+
f+'_count" name="'+f+'_count" value="0" /></div>')}var m={};b.fn.pluploadQueue=function(f){return f?(this.each(function(){function k(a){var e;a.status==plupload.DONE&&(e="plupload_done");a.status==plupload.FAILED&&(e="plupload_failed");a.status==plupload.QUEUED&&(e="plupload_delete");a.status==plupload.UPLOADING&&(e="plupload_uploading");e=b("#"+a.id).attr("class",e).find("a").css("display","block");a.hint&&e.attr("title",a.hint)}function q(){b("span.plupload_total_status",d).html(a.total.percent+
"%");b("div.plupload_progress_bar",d).css("width",a.total.percent+"%");b("span.plupload_upload_status",d).html(p.sprintf(c("Uploaded %d/%d files"),a.total.uploaded,a.files.length))}function l(){var f=b("ul.plupload_filelist",d).html(""),e=0,h;b.each(a.files,function(d,c){h="";c.status==plupload.DONE&&(c.target_name&&(h+='<input type="hidden" name="'+g+"_"+e+'_tmpname" value="'+plupload.xmlEncode(c.target_name)+'" />'),h+='<input type="hidden" name="'+g+"_"+e+'_name" value="'+plupload.xmlEncode(c.name)+
'" />',h+='<input type="hidden" name="'+g+"_"+e+'_status" value="'+(c.status==plupload.DONE?"done":"failed")+'" />',e++,b("#"+g+"_count").val(e));f.append('<li id="'+c.id+'"><div class="plupload_file_name"><span>'+c.name+'</span></div><div class="plupload_file_action"><a href="#"></a></div><div class="plupload_file_status">'+c.percent+'%</div><div class="plupload_file_size">'+plupload.formatSize(c.size)+'</div><div class="plupload_clearer">&nbsp;</div>'+h+"</li>");k(c);b("#"+c.id+".plupload_delete a").click(function(e){b("#"+
c.id).remove();a.removeFile(c);e.preventDefault()})});b("span.plupload_total_file_size",d).html(plupload.formatSize(a.total.size));0===a.total.queued?b("span.plupload_add_text",d).html(c("Add Files")):b("span.plupload_add_text",d).html(p.sprintf(c("%d files queued"),a.total.queued));b("a.plupload_start",d).toggleClass("plupload_disabled",a.files.length==a.total.uploaded+a.total.failed);f[0].scrollTop=f[0].scrollHeight;q();!a.files.length&&a.features.dragdrop&&a.settings.dragdrop&&b("#"+g+"_filelist").append('<li class="plupload_droptext">'+
c("Drag files here.")+"</li>")}var a,d,g,n;d=b(this);g=d.attr("id");g||(g=plupload.guid(),d.attr("id",g));n=d.html();r(g,d);f=b.extend({dragdrop:!0,browse_button:g+"_browse",container:g},f);f.dragdrop&&(f.drop_element=g+"_filelist");a=new plupload.Uploader(f);m[g]=a;a.bind("UploadFile",function(a,c){b("#"+c.id).addClass("plupload_current_file")});a.bind("Init",function(c,e){if(!f.unique_names&&f.rename)d.on("click","#"+g+"_filelist div.plupload_file_name span",function(a){var e=b(a.target),d,f,g=
"";d=c.getFile(e.parents("li")[0].id);f=d.name;if(a=/^(.+)(\.[^.]+)$/.exec(f))f=a[1],g=a[2];e.hide().after('<input type="text" />');e.next().val(f).focus().blur(function(){e.show().next().remove()}).keydown(function(a){var c=b(this);13==a.keyCode&&(a.preventDefault(),d.name=c.val()+g,e.html(d.name),c.blur())})});b("#"+g+"_container").attr("title","Using runtime: "+e.runtime);b("a.plupload_start",d).click(function(c){b(this).hasClass("plupload_disabled")||a.start();c.preventDefault()});b("a.plupload_stop",
d).click(function(b){b.preventDefault();a.stop()});b("a.plupload_start",d).addClass("plupload_disabled")});a.bind("Error",function(f,e){var h=e.file,k;h&&(k=e.message,e.details&&(k+=" ("+e.details+")"),e.code==plupload.FILE_SIZE_ERROR&&alert(c("Error: File too large:")+" "+h.name),e.code==plupload.FILE_EXTENSION_ERROR&&alert(c("Error: Invalid file extension:")+" "+h.name),h.hint=k,b("#"+h.id).attr("class","plupload_failed").find("a").css("display","block").attr("title",k));e.code===plupload.INIT_ERROR&&
setTimeout(function(){delete m[g];a.destroy();d.html(n);a=d=n=null},1)});a.bind("PostInit",function(a){a.settings.dragdrop&&a.features.dragdrop&&b("#"+g+"_filelist").append('<li class="plupload_droptext">'+c("Drag files here.")+"</li>")});a.init();a.bind("StateChanged",function(){a.state===plupload.STARTED?(b("li.plupload_delete a,div.plupload_buttons",d).hide(),a.disableBrowse(!0),b("span.plupload_upload_status,div.plupload_progress,a.plupload_stop",d).css("display","block"),b("span.plupload_upload_status",
d).html("Uploaded "+a.total.uploaded+"/"+a.files.length+" files"),f.multiple_queues&&b("span.plupload_total_status,span.plupload_total_file_size",d).show()):(l(),b("a.plupload_stop,div.plupload_progress",d).hide(),b("a.plupload_delete",d).css("display","block"),f.multiple_queues&&a.total.uploaded+a.total.failed==a.files.length&&(b(".plupload_buttons,.plupload_upload_status",d).css("display","inline"),a.disableBrowse(!1),b(".plupload_start",d).addClass("plupload_disabled"),b("span.plupload_total_status,span.plupload_total_file_size",
d).hide()))});a.bind("FilesAdded",l);a.bind("FilesRemoved",function(){var a=b("#"+g+"_filelist").scrollTop();l();b("#"+g+"_filelist").scrollTop(a)});a.bind("FileUploaded",function(a,b){k(b)});a.bind("UploadProgress",function(a,c){b("#"+c.id+" div.plupload_file_status",d).html(c.percent+"%");k(c);q()});f.setup&&f.setup(a)}),this):m[b(this[0]).attr("id")]}})(jQuery,mOxie);
